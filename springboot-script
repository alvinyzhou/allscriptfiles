node("master"){
    stage("checkout"){
        checkout([$class: 'GitSCM', branches: [[name: '*/master']], doGenerateSubmoduleConfigurations: false, extensions: [], submoduleCfg: [], userRemoteConfigs: [[credentialsId: 'githubProfile', url: 'git@github.com:alvinyzhou/alvinSpBoot.git']]])   
    }

    stage("mvn build"){
        echo "return status bat start"
        //bat returnStatus: true, script: 'mvn clean install '
        sh 'java -version'
        sh 'echo %JAVA_HOME%'
        sh 'mvn clean install'
        echo "return status bat end"
        
        //echo "simple bat start"
        //bat 'mvn clean install '
        //echo "simple bat end"
    }
    
    
   stage("deploy to Tomcat"){
        echo "Current path"
        sh "pwd"
        //sh "./deploy.sh"
        sh "rm -r -f /home/ducex/apache-tomcat-8.5.23/webapps/comapp-0.0.1-SNAPSHOT.war"
        sh "cp -f /root/.jenkins/workspace/demo/ci-cd-demo/target/comapp-0.0.1-SNAPSHOT.war /home/ducex/apache-tomcat-8.5.23/webapps/comapp-0.0.1-SNAPSHOT.war"
   }
}
